syntax = "proto3";

package cinebrain;

// Content item for search results
message ContentItem {
    int32 id = 1;
    string title = 2;
    string original_title = 3;
    enum ContentType {
        UNKNOWN = 0;
        MOVIE = 1;
        TV = 2;
        ANIME = 3;
    }
    ContentType type = 4;
    int32 year = 5;
    repeated string languages = 6;
    repeated string genres = 7;
    string poster_url = 8;
    string backdrop_url = 9;
    string description = 10;
    float rating = 11;
    int32 vote_count = 12;
    float popularity = 13;
    string release_date = 14;
    int32 runtime = 15;
    string youtube_trailer_id = 16;
    bool is_trending = 17;
    bool is_new_release = 18;
    bool is_critics_choice = 19;
    
    // Additional metadata
    map<string, string> metadata = 20;
}

// Search request
message SearchRequest {
    string query = 1;
    string search_type = 2;
    int32 page = 3;
    int32 limit = 4;
    map<string, string> filters = 5;
    bool use_protobuf = 6; // Client capability flag
}

// Search response
message SearchResponse {
    repeated ContentItem results = 1;
    int32 total_results = 2;
    int32 page = 3;
    string query = 4;
    float search_time_ms = 5;
    bool instant = 6;
    repeated string suggestions = 7;
    
    // Search metadata
    message SearchMeta {
        string source = 1; // instant, cache, backend
        repeated string available_filters = 2;
        map<string, int32> facets = 3;
    }
    SearchMeta metadata = 8;
}

// Autocomplete response
message AutocompleteResponse {
    message Suggestion {
        int32 id = 1;
        string title = 2;
        string type = 3;
        int32 year = 4;
        string poster_url = 5;
        float rating = 6;
        bool is_telugu = 7;
    }
    repeated Suggestion suggestions = 1;
}

// Content details response
message ContentDetailsResponse {
    ContentItem content = 1;
    repeated ContentItem similar_content = 2;
    repeated CastMember cast = 3;
    repeated CrewMember crew = 4;
    
    message CastMember {
        string name = 1;
        string character = 2;
        string profile_path = 3;
    }
    
    message CrewMember {
        string name = 1;
        string job = 2;
        string department = 3;
    }
}

// Batch content request for preloading
message BatchContentRequest {
    repeated int32 content_ids = 1;
}

message BatchContentResponse {
    map<int32, ContentItem> contents = 1;
}