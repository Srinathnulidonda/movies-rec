<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaAI - Movie Recommendations</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh}.glass{backdrop-filter:blur(10px);background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2)}.movie-card{transition:all 0.3s ease;transform-origin:center}.movie-card:hover{transform:scale(1.05);box-shadow:0 25px 50px -12px rgba(0,0,0,0.5)}.gradient-text{background:linear-gradient(45deg,#f093fb 0%,#f5576c 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.loading{animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
</head>
<body>
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-5xl font-bold text-white mb-4 gradient-text">ðŸŽ¬ CinemaAI</h1>
            <p class="text-xl text-white opacity-80">Discover your next favorite movie, anime, or series</p>
        </header>

        <!-- Navigation -->
        <nav class="glass p-4 rounded-2xl mb-8">
            <div class="flex justify-center space-x-6">
                <button onclick="showSection('home')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">Home</button>
                <button onclick="showSection('search')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">Search</button>
                <button onclick="showSection('recommendations')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">For You</button>
                <button onclick="showSection('wishlist')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">Wishlist</button>
                <button onclick="showSection('favorites')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">Favorites</button>
                <button onclick="showSection('login')" class="text-white hover:text-pink-300 px-4 py-2 rounded-lg transition-colors">Login</button>
            </div>
        </nav>

        <!-- Home Section -->
        <div id="home" class="section">
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold text-white mb-6">Featured Today</h2>
                <div id="featured-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Search Section -->
        <div id="search" class="section hidden">
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold text-white mb-6">Search Movies, Anime & Series</h2>
                <div class="flex space-x-4 mb-6">
                    <input type="text" id="searchInput" placeholder="Search for movies, anime, series..." class="flex-1 p-3 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:outline-none focus:ring-2 focus:ring-pink-400">
                    <button onclick="searchContent()" class="bg-gradient-to-r from-pink-500 to-purple-600 text-white px-8 py-3 rounded-lg hover:opacity-90 transition-opacity">Search</button>
                </div>
                <div class="flex space-x-4 mb-6">
                    <button onclick="filterContent('movie')" class="bg-blue-500/30 text-white px-4 py-2 rounded-lg hover:bg-blue-500/50 transition-colors">Movies</button>
                    <button onclick="filterContent('tv')" class="bg-green-500/30 text-white px-4 py-2 rounded-lg hover:bg-green-500/50 transition-colors">TV Series</button>
                    <button onclick="filterContent('anime')" class="bg-red-500/30 text-white px-4 py-2 rounded-lg hover:bg-red-500/50 transition-colors">Anime</button>
                </div>
                <div id="search-results" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div id="recommendations" class="section hidden">
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold text-white mb-6">Personalized For You</h2>
                <div id="recommendations-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Wishlist Section -->
        <div id="wishlist" class="section hidden">
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold text-white mb-6">Your Wishlist</h2>
                <div id="wishlist-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Favorites Section -->
        <div id="favorites" class="section hidden">
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold text-white mb-6">Your Favorites</h2>
                <div id="favorites-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Login Section -->
        <div id="login" class="section hidden">
            <div class="glass p-8 rounded-2xl max-w-md mx-auto">
                <h2 class="text-3xl font-bold text-white mb-6 text-center">Login</h2>
                <form id="loginForm" class="space-y-4">
                    <input type="email" id="email" placeholder="Email" class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:outline-none focus:ring-2 focus:ring-pink-400">
                    <input type="password" id="password" placeholder="Password" class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30 focus:outline-none focus:ring-2 focus:ring-pink-400">
                    <button type="submit" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-lg hover:opacity-90 transition-opacity">Login</button>
                </form>
                <p class="text-white/70 text-center mt-4">Don't have an account? <button onclick="showRegister()" class="text-pink-300 hover:underline">Register</button></p>
            </div>
        </div>

        <!-- Movie Detail Modal -->
        <div id="movieModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50">
            <div class="flex items-center justify-center min-h-screen p-4">
                <div class="glass max-w-4xl w-full rounded-2xl p-8 max-h-[90vh] overflow-y-auto">
                    <div class="flex justify-between items-start mb-6">
                        <h2 id="modalTitle" class="text-3xl font-bold text-white"></h2>
                        <button onclick="closeModal()" class="text-white/70 hover:text-white text-2xl">Ã—</button>
                    </div>
                    <div id="modalContent" class="text-white"></div>
                </div>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loading" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-40">
            <div class="flex items-center justify-center min-h-screen">
                <div class="loading w-12 h-12 border-4 border-pink-400 border-t-transparent rounded-full"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://movies-rec-1hcv.onrender.com';
        let currentUser = null;

        // Navigation
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionName).classList.remove('hidden');
            
            if (sectionName === 'home') loadFeatured();
            if (sectionName === 'recommendations') loadRecommendations();
            if (sectionName === 'wishlist') loadWishlist();
            if (sectionName === 'favorites') loadFavorites();
        }

        // Loading state
        function showLoading() { document.getElementById('loading').classList.remove('hidden'); }
        function hideLoading() { document.getElementById('loading').classList.add('hidden'); }

        // API calls
        async function apiCall(endpoint, options = {}) {
            try {
                showLoading();
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: { 'Content-Type': 'application/json', ...options.headers },
                    ...options
                });
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                return { error: 'Network error' };
            } finally {
                hideLoading();
            }
        }

        // Load featured content
        async function loadFeatured() {
            const data = await apiCall('/featured');
            if (data.results) {
                document.getElementById('featured-content').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Search functionality
        async function searchContent() {
            const query = document.getElementById('searchInput').value;
            if (!query) return;
            
            const data = await apiCall(`/search?q=${encodeURIComponent(query)}`);
            if (data.results) {
                document.getElementById('search-results').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Filter content
        async function filterContent(type) {
            const data = await apiCall(`/search?type=${type}`);
            if (data.results) {
                document.getElementById('search-results').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Load recommendations
        async function loadRecommendations() {
            if (!currentUser) return;
            const data = await apiCall('/recommendations', { headers: { 'Authorization': `Bearer ${currentUser.token}` }});
            if (data.results) {
                document.getElementById('recommendations-content').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Load wishlist
        async function loadWishlist() {
            if (!currentUser) return;
            const data = await apiCall('/wishlist', { headers: { 'Authorization': `Bearer ${currentUser.token}` }});
            if (data.results) {
                document.getElementById('wishlist-content').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Load favorites
        async function loadFavorites() {
            if (!currentUser) return;
            const data = await apiCall('/favorites', { headers: { 'Authorization': `Bearer ${currentUser.token}` }});
            if (data.results) {
                document.getElementById('favorites-content').innerHTML = data.results.map(createMovieCard).join('');
            }
        }

        // Create movie card
        function createMovieCard(movie) {
            return `
                <div class="movie-card glass p-4 rounded-xl cursor-pointer" onclick="showMovieDetail(${movie.id})">
                    <img src="${movie.poster || '/api/placeholder/300/450'}" alt="${movie.title}" class="w-full h-64 object-cover rounded-lg mb-4">
                    <h3 class="text-white font-bold text-lg mb-2">${movie.title}</h3>
                    <p class="text-white/70 text-sm mb-2">${movie.year} â€¢ ${movie.rating}/10</p>
                    <p class="text-white/60 text-sm line-clamp-3">${movie.overview}</p>
                </div>
            `;
        }

        // Show movie detail
        async function showMovieDetail(movieId) {
            const data = await apiCall(`/movie/${movieId}`);
            if (data.movie) {
                const movie = data.movie;
                document.getElementById('modalTitle').textContent = movie.title;
                document.getElementById('modalContent').innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1">
                            <img src="${movie.poster}" alt="${movie.title}" class="w-full rounded-lg">
                            <div class="mt-4 space-y-2">
                                <button onclick="addToWishlist(${movie.id})" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors">+ Wishlist</button>
                                <button onclick="addToFavorites(${movie.id})" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition-colors">â™¥ Favorite</button>
                            </div>
                        </div>
                        <div class="lg:col-span-2">
                            <div class="mb-6">
                                <p class="text-lg mb-2">${movie.year} â€¢ ${movie.runtime} min â€¢ ${movie.rating}/10</p>
                                <p class="text-white/80 mb-4">${movie.overview}</p>
                                <div class="mb-4">
                                    <h4 class="font-bold mb-2">Genres:</h4>
                                    <div class="flex flex-wrap gap-2">
                                        ${movie.genres?.map(g => `<span class="bg-white/20 px-3 py-1 rounded-full text-sm">${g}</span>`).join('') || ''}
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <h4 class="font-bold mb-2">Cast:</h4>
                                    <p class="text-white/80">${movie.cast?.join(', ') || 'Cast information not available'}</p>
                                </div>
                            </div>
                            <div class="mb-6">
                                <h4 class="font-bold mb-4">Watch On:</h4>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                    ${movie.watch_providers?.map(p => `
                                        <a href="${p.link}" target="_blank" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-3 rounded-lg text-center hover:opacity-90 transition-opacity">
                                            ${p.provider}
                                        </a>
                                    `).join('') || '<p class="text-white/60">Watch providers not available</p>'}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('movieModal').classList.remove('hidden');
            }
        }

        // Close modal
        function closeModal() {
            document.getElementById('movieModal').classList.add('hidden');
        }

        // Add to wishlist
        async function addToWishlist(movieId) {
            if (!currentUser) { alert('Please login first'); return; }
            await apiCall('/wishlist', {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${currentUser.token}` },
                body: JSON.stringify({ movie_id: movieId })
            });
            alert('Added to wishlist!');
        }

        // Add to favorites
        async function addToFavorites(movieId) {
            if (!currentUser) { alert('Please login first'); return; }
            await apiCall('/favorites', {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${currentUser.token}` },
                body: JSON.stringify({ movie_id: movieId })
            });
            alert('Added to favorites!');
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            const data = await apiCall('/login', {
                method: 'POST',
                body: JSON.stringify({ email, password })
            });
            
            if (data.token) {
                currentUser = data;
                alert('Login successful!');
                showSection('home');
            } else {
                alert('Login failed');
            }
        });

        // Register
        function showRegister() {
            alert('Registration feature coming soon!');
        }

        // Enter key search
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') searchContent();
        });

        // Initialize
        loadFeatured();
    </script>
</body>
</html>